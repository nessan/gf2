<!-- HTML header for doxygen 1.15.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
    <head>
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=11" />
        <meta name="generator" content="Doxygen 1.15.0" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>GF2++: BitGauss.h Source File</title>
        <link href="tabs.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <script type="text/javascript" src="clipboard.js"></script>
        <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
 <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
        <!-- ... other metadata & script includes ... -->
        <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
        <script type="text/javascript">
            DoxygenAwesomeDarkModeToggle.init();
        </script>
    </head>
    <body>
            <div id="top">
                <!-- do not remove this div, it is closed by doxygen! -->
                <div id="titlearea">
                    <table cellspacing="0" cellpadding="0">
                        <tbody>
                            <tr id="projectrow">
                                <td id="projectalign">
                                    <div id="projectname">
                                        GF2++
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- end header part -->
            </div>
        </div>
    </body>
</html>
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('BitGauss_8h_source.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">BitGauss.h</div></div>
</div><!--header-->
<div class="contents">
<a href="BitGauss_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// SPDX-FileCopyrightText: 2025 Nessan Fitzmaurice &lt;nzznfitz+gh@icloud.com&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// SPDX-License-Identifier: MIT</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;<a class="code" href="BitMatrix_8h.html">gf2/BitMatrix.h</a>&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacegf2.html">gf2</a> {</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="keyword">template</span>&lt;Un<span class="keywordtype">signed</span> Word&gt;</div>
<div class="foldopen" id="foldopen00045" data-start="{" data-end="};">
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno"><a class="line" href="classgf2_1_1BitGauss.html">   45</a></span><span class="keyword">class </span><a class="code hl_function" href="classgf2_1_1BitGauss.html#abcd21e0701d0cd6e34bebf0bc6ac76de">BitGauss</a> {</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <a class="code hl_class" href="classgf2_1_1BitMatrix.html">BitMatrix&lt;Word&gt;</a>    m_A;         <span class="comment">// The reduced row echelon form of the matrix `A`.</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <a class="code hl_class" href="classgf2_1_1BitVector.html">BitVector&lt;Word&gt;</a>    m_b;         <span class="comment">// The equivalent reduced row echelon form of the vector `b`.</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    <a class="code hl_typedef" href="namespacegf2.html#abed1a83530f112d069e809d8883c13a8">usize</a>              m_rank;      <span class="comment">// The rank of the matrix `A`.</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    <a class="code hl_typedef" href="namespacegf2.html#abed1a83530f112d069e809d8883c13a8">usize</a>              m_solutions; <span class="comment">// The number of solutions to the system.</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    std::vector&lt;usize&gt; m_free;      <span class="comment">// The indices of the free variables in the system.</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <span class="keyword">template</span>&lt;BitStore Rhs&gt;</div>
<div class="foldopen" id="foldopen00071" data-start="{" data-end="}">
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno"><a class="line" href="classgf2_1_1BitGauss.html#abcd21e0701d0cd6e34bebf0bc6ac76de">   71</a></span>    <a class="code hl_function" href="classgf2_1_1BitGauss.html#abcd21e0701d0cd6e34bebf0bc6ac76de">BitGauss</a>(<a class="code hl_class" href="classgf2_1_1BitMatrix.html">BitMatrix&lt;Word&gt;</a> <span class="keyword">const</span>&amp; A, Rhs <span class="keyword">const</span>&amp; b)</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>        <span class="keyword">requires</span> std::same_as&lt;typename Rhs::word_type, Word&gt;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    {</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        <a class="code hl_define" href="assert_8h.html#a8b8f43b80dc4843439f1a05910d5ad65">gf2_assert</a>(A.is_square(), <span class="stringliteral">&quot;Matrix is {} x {} but it should be square!&quot;</span>, A.rows(), A.cols());</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        <a class="code hl_define" href="assert_8h.html#a8b8f43b80dc4843439f1a05910d5ad65">gf2_assert</a>(A.rows() == b.size(), <span class="stringliteral">&quot;Matrix has {} rows but the RHS vector has {} elements.&quot;</span>, A.rows(), b.size());</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        <span class="comment">// Copy A &amp; augment it with b on the right.</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        m_A = A;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        m_A.append_col(b);</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        <span class="comment">// Reduce the augmented matrix to reduced row echelon form.</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>        <span class="keyword">auto</span> has_pivot = m_A.to_reduced_echelon_form();</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>        <span class="comment">// Grab the last column of the reduced augmented matrix as a standalone vector, removing it from the matrix.</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        m_b = m_A.remove_col().value();</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        <span class="comment">// Also pop the last element of the `has_pivot` bit-vector as it corresponds to the column that we just removed.</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        has_pivot.pop();</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>        <span class="comment">// The rank is the number of columns with a pivot (it is also the number if non-zero rows in the reduced</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        <span class="comment">// matrix).</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>        m_rank = has_pivot.count_ones();</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>        <span class="comment">// Any columns without a pivot are free variables.</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = 0uz; i &lt; has_pivot.size(); ++i) {</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>            <span class="keywordflow">if</span> (!has_pivot[i]) m_free.push_back(i);</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        }</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        <span class="comment">// Check that all zero rows in the reduced matrix are matched by zero elements in the equivalent reduced right</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>        <span class="comment">// hand side vector (this is consistency). Zero rows are at the bottom from `rank` to the end.</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>        <span class="keyword">auto</span> consistent = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = m_rank; i &lt; m_A.rows(); ++i) {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>            <span class="keywordflow">if</span> (m_b[i]) {</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>                consistent = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>            }</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>        }</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>        <span class="comment">// The number of solutions we can index into is either 0 or 2^f where f is the number of free variables.</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>        <span class="comment">// However, for practical reasons we limit the number of solutions to `min(2^f, 2^63)`.</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>        m_solutions = 0;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>        <span class="keywordflow">if</span> (consistent) {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>            <span class="keyword">auto</span> f = m_free.size();</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>            <span class="keyword">auto</span> b_max = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="namespacegf2.html#abed1a83530f112d069e809d8883c13a8">usize</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="namespacegf2.html#ad1d8969ed4ed705fbc26eec1eed8b6ae">BITS&lt;Word&gt;</a> - 1);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            <span class="keyword">auto</span> f_max = std::min(f, b_max);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>            m_solutions = 1uz &lt;&lt; f_max;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        }</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    }</div>
</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno"><a class="line" href="classgf2_1_1BitGauss.html#acd4558c6be39be31de21579ee8ed83c1">  129</a></span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="namespacegf2.html#abed1a83530f112d069e809d8883c13a8">usize</a> <a class="code hl_function" href="classgf2_1_1BitGauss.html#acd4558c6be39be31de21579ee8ed83c1">rank</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_rank; }</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno"><a class="line" href="classgf2_1_1BitGauss.html#ae38514e77d263fe665219b4b9cdbbedb">  140</a></span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="namespacegf2.html#abed1a83530f112d069e809d8883c13a8">usize</a> <a class="code hl_function" href="classgf2_1_1BitGauss.html#ae38514e77d263fe665219b4b9cdbbedb">free_count</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_free.size(); }</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno"><a class="line" href="classgf2_1_1BitGauss.html#a5554b0eba1aecf1ae286094b254c4623">  151</a></span>    <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classgf2_1_1BitGauss.html#a5554b0eba1aecf1ae286094b254c4623">is_underdetermined</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !m_free.empty(); }</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno"><a class="line" href="classgf2_1_1BitGauss.html#a8574e247860dec04f826a723ecb098fb">  164</a></span>    <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classgf2_1_1BitGauss.html#a8574e247860dec04f826a723ecb098fb">is_consistent</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_solutions &gt; 0; }</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno"><a class="line" href="classgf2_1_1BitGauss.html#aaa7df7ea05c8204898229089f69f477a">  180</a></span>    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="namespacegf2.html#abed1a83530f112d069e809d8883c13a8">usize</a> <a class="code hl_function" href="classgf2_1_1BitGauss.html#aaa7df7ea05c8204898229089f69f477a">solution_count</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_solutions; }</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span></div>
<div class="foldopen" id="foldopen00195" data-start="{" data-end="}">
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno"><a class="line" href="classgf2_1_1BitGauss.html#a9726ce68a368c0e7fb737de927b9248c">  195</a></span>    std::optional&lt;BitVector&lt;Word&gt;&gt; <a class="code hl_function" href="classgf2_1_1BitGauss.html#a9726ce68a368c0e7fb737de927b9248c">operator()</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="classgf2_1_1BitGauss.html#a8574e247860dec04f826a723ecb098fb">is_consistent</a>()) <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        <span class="comment">// Create a random starting point.</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        <span class="keyword">auto</span> x = <a class="code hl_function" href="classgf2_1_1BitVector.html#a4b7006134bcff1ddfc81bcc8133dd3cc">BitVector&lt;Word&gt;::random</a>(m_b.size());</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span> </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        <span class="comment">// All non-free variables will be overwritten by back substitution.</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        back_substitute_into(x);</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        <span class="keywordflow">return</span> x;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    }</div>
</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span></div>
<div class="foldopen" id="foldopen00228" data-start="{" data-end="}">
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno"><a class="line" href="classgf2_1_1BitGauss.html#a5cbb4c60e3acabe9e4a6d2e09ae84b4f">  228</a></span>    std::optional&lt;BitVector&lt;Word&gt;&gt; <a class="code hl_function" href="classgf2_1_1BitGauss.html#a5cbb4c60e3acabe9e4a6d2e09ae84b4f">operator()</a>(<a class="code hl_typedef" href="namespacegf2.html#abed1a83530f112d069e809d8883c13a8">usize</a> i_solution)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="classgf2_1_1BitGauss.html#a8574e247860dec04f826a723ecb098fb">is_consistent</a>()) { <span class="keywordflow">return</span> std::nullopt; }</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        <span class="keywordflow">if</span> (i_solution &gt; <a class="code hl_function" href="classgf2_1_1BitGauss.html#aaa7df7ea05c8204898229089f69f477a">solution_count</a>()) { <span class="keywordflow">return</span> std::nullopt; }</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        <span class="comment">// We start with a zero vector and then set the free variable slots to the fixed bit pattern for `i`.</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        <span class="keyword">auto</span> x = <a class="code hl_function" href="classgf2_1_1BitVector.html#a66ff1e24db7bf631af2d638dd0b620c1">BitVector&lt;Word&gt;::zeros</a>(m_b.size());</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> f = 0uz; f &lt; m_free.size(); ++f) {</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>            x[m_free[f]] = (i_solution &amp; 1);</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>            i_solution &gt;&gt;= 1;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        }</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>        <span class="comment">// Back substitution will now overwrite any non-free variables in `x` with their correct values.</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        back_substitute_into(x);</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        <span class="keywordflow">return</span> x;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    }</div>
</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <span class="comment">// Helper function that performs back substitution to solve for the non-free variables in `x`.</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <span class="keywordtype">void</span> back_substitute_into(<a class="code hl_class" href="classgf2_1_1BitVector.html">BitVector&lt;Word&gt;</a>&amp; x)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        <span class="comment">// Iterate from the bottom up, starting at the first non-zero row, solving for the non-free variables in `x`.</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = m_rank; i--;) {</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>            <span class="keyword">auto</span> j = m_A[i].first_set().value();</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>            x.<a class="code hl_function" href="classgf2_1_1BitVector.html#a73c5c0d160af7ae95e495e1288f73440">set</a>(j, m_b[i]);</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> k = j + 1; k &lt; x.<a class="code hl_function" href="classgf2_1_1BitVector.html#a8b10006eb120ea7fafdeecf68adb53cb">size</a>(); ++k)</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>                <span class="keywordflow">if</span> (m_A(i, k)) { x.<a class="code hl_function" href="classgf2_1_1BitVector.html#a73c5c0d160af7ae95e495e1288f73440">set</a>(j, x[j] ^ x[k]); }</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        }</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    }</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>};</div>
</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span> </div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>} <span class="comment">// namespace gf2</span></div>
<div class="ttc" id="aBitMatrix_8h_html"><div class="ttname"><a href="BitMatrix_8h.html">BitMatrix.h</a></div><div class="ttdoc">Matrices over over GF(2) â€“ bit-matrices.   See the BitMatrix page for more details.</div></div>
<div class="ttc" id="aassert_8h_html_a8b8f43b80dc4843439f1a05910d5ad65"><div class="ttname"><a href="assert_8h.html#a8b8f43b80dc4843439f1a05910d5ad65">gf2_assert</a></div><div class="ttdeci">#define gf2_assert(cond,...)</div><div class="ttdoc">A confirmation macro that checks a boolean condition cond.   On failure, the confirmation prints an e...</div><div class="ttdef"><b>Definition</b> assert.h:98</div></div>
<div class="ttc" id="aclassgf2_1_1BitGauss_html_a5554b0eba1aecf1ae286094b254c4623"><div class="ttname"><a href="classgf2_1_1BitGauss.html#a5554b0eba1aecf1ae286094b254c4623">gf2::BitGauss::is_underdetermined</a></div><div class="ttdeci">constexpr bool is_underdetermined() const</div><div class="ttdoc">Returns true if the system is underdetermined.</div><div class="ttdef"><b>Definition</b> BitGauss.h:151</div></div>
<div class="ttc" id="aclassgf2_1_1BitGauss_html_a5cbb4c60e3acabe9e4a6d2e09ae84b4f"><div class="ttname"><a href="classgf2_1_1BitGauss.html#a5cbb4c60e3acabe9e4a6d2e09ae84b4f">gf2::BitGauss::operator()</a></div><div class="ttdeci">std::optional&lt; BitVector&lt; Word &gt; &gt; operator()(usize i_solution) const</div><div class="ttdoc">Returns the ith solution to the system of linear equations A.x = b or std::nullopt if the system is i...</div><div class="ttdef"><b>Definition</b> BitGauss.h:228</div></div>
<div class="ttc" id="aclassgf2_1_1BitGauss_html_a8574e247860dec04f826a723ecb098fb"><div class="ttname"><a href="classgf2_1_1BitGauss.html#a8574e247860dec04f826a723ecb098fb">gf2::BitGauss::is_consistent</a></div><div class="ttdeci">constexpr bool is_consistent() const</div><div class="ttdoc">Returns true if the system of linear equations A.x = b is consistent.</div><div class="ttdef"><b>Definition</b> BitGauss.h:164</div></div>
<div class="ttc" id="aclassgf2_1_1BitGauss_html_a9726ce68a368c0e7fb737de927b9248c"><div class="ttname"><a href="classgf2_1_1BitGauss.html#a9726ce68a368c0e7fb737de927b9248c">gf2::BitGauss::operator()</a></div><div class="ttdeci">std::optional&lt; BitVector&lt; Word &gt; &gt; operator()() const</div><div class="ttdoc">Returns a solution to the system of linear equations A.x = b or std::nullopt if the system is inconsi...</div><div class="ttdef"><b>Definition</b> BitGauss.h:195</div></div>
<div class="ttc" id="aclassgf2_1_1BitGauss_html_aaa7df7ea05c8204898229089f69f477a"><div class="ttname"><a href="classgf2_1_1BitGauss.html#aaa7df7ea05c8204898229089f69f477a">gf2::BitGauss::solution_count</a></div><div class="ttdeci">constexpr usize solution_count() const</div><div class="ttdoc">Returns the maximum number of solutions we can index into.</div><div class="ttdef"><b>Definition</b> BitGauss.h:180</div></div>
<div class="ttc" id="aclassgf2_1_1BitGauss_html_abcd21e0701d0cd6e34bebf0bc6ac76de"><div class="ttname"><a href="classgf2_1_1BitGauss.html#abcd21e0701d0cd6e34bebf0bc6ac76de">gf2::BitGauss::BitGauss</a></div><div class="ttdeci">BitGauss(BitMatrix&lt; Word &gt; const &amp;A, Rhs const &amp;b)</div><div class="ttdoc">Constructs a new BitGauss object where we are solving the system of linear equations A....</div><div class="ttdef"><b>Definition</b> BitGauss.h:71</div></div>
<div class="ttc" id="aclassgf2_1_1BitGauss_html_acd4558c6be39be31de21579ee8ed83c1"><div class="ttname"><a href="classgf2_1_1BitGauss.html#acd4558c6be39be31de21579ee8ed83c1">gf2::BitGauss::rank</a></div><div class="ttdeci">constexpr usize rank() const</div><div class="ttdoc">Returns the rank of the matrix A.</div><div class="ttdef"><b>Definition</b> BitGauss.h:129</div></div>
<div class="ttc" id="aclassgf2_1_1BitGauss_html_ae38514e77d263fe665219b4b9cdbbedb"><div class="ttname"><a href="classgf2_1_1BitGauss.html#ae38514e77d263fe665219b4b9cdbbedb">gf2::BitGauss::free_count</a></div><div class="ttdeci">constexpr usize free_count() const</div><div class="ttdoc">Returns the number of free variables in the system.</div><div class="ttdef"><b>Definition</b> BitGauss.h:140</div></div>
<div class="ttc" id="aclassgf2_1_1BitMatrix_html"><div class="ttname"><a href="classgf2_1_1BitMatrix.html">gf2::BitMatrix</a></div><div class="ttdoc">A dynamically-sized matrix over GF(2) stored as a vector of bit-vectors representing the rows of the ...</div><div class="ttdef"><b>Definition</b> BitMatrix.h:33</div></div>
<div class="ttc" id="aclassgf2_1_1BitVector_html"><div class="ttname"><a href="classgf2_1_1BitVector.html">gf2::BitVector</a></div><div class="ttdoc">A dynamically-sized vector over GF(2) with bit elements compactly stored in a standard vector of prim...</div><div class="ttdef"><b>Definition</b> BitVector.h:23</div></div>
<div class="ttc" id="aclassgf2_1_1BitVector_html_a4b7006134bcff1ddfc81bcc8133dd3cc"><div class="ttname"><a href="classgf2_1_1BitVector.html#a4b7006134bcff1ddfc81bcc8133dd3cc">gf2::BitVector::random</a></div><div class="ttdeci">static BitVector random(usize size, double p=0.5, u64 seed=0)</div><div class="ttdoc">Factory method to generate a bit-vector of size size where the elements are picked at random.</div><div class="ttdef"><b>Definition</b> BitVector.h:348</div></div>
<div class="ttc" id="aclassgf2_1_1BitVector_html_a66ff1e24db7bf631af2d638dd0b620c1"><div class="ttname"><a href="classgf2_1_1BitVector.html#a66ff1e24db7bf631af2d638dd0b620c1">gf2::BitVector::zeros</a></div><div class="ttdeci">static constexpr BitVector zeros(usize n)</div><div class="ttdoc">Factory method to generate a bit-vector of length n where the elements are all 0.</div><div class="ttdef"><b>Definition</b> BitVector.h:196</div></div>
<div class="ttc" id="aclassgf2_1_1BitVector_html_a73c5c0d160af7ae95e495e1288f73440"><div class="ttname"><a href="classgf2_1_1BitVector.html#a73c5c0d160af7ae95e495e1288f73440">gf2::BitVector::set</a></div><div class="ttdeci">constexpr auto set(usize i, bool value=true)</div><div class="ttdoc">Sets the bit-element i to the specified boolean value &amp; returns this for chaining....</div><div class="ttdef"><b>Definition</b> BitVector.h:984</div></div>
<div class="ttc" id="aclassgf2_1_1BitVector_html_a8b10006eb120ea7fafdeecf68adb53cb"><div class="ttname"><a href="classgf2_1_1BitVector.html#a8b10006eb120ea7fafdeecf68adb53cb">gf2::BitVector::size</a></div><div class="ttdeci">constexpr usize size() const</div><div class="ttdoc">Returns the number of bit-elements in the bit-vector.</div><div class="ttdef"><b>Definition</b> BitVector.h:50</div></div>
<div class="ttc" id="anamespacegf2_html"><div class="ttname"><a href="namespacegf2.html">gf2</a></div><div class="ttdoc">The namespace for the gf2 library.</div><div class="ttdef"><b>Definition</b> assert.h:119</div></div>
<div class="ttc" id="anamespacegf2_html_abed1a83530f112d069e809d8883c13a8"><div class="ttname"><a href="namespacegf2.html#abed1a83530f112d069e809d8883c13a8">gf2::usize</a></div><div class="ttdeci">std::size_t usize</div><div class="ttdoc">Word type alias for the platform&#39;s &quot;native&quot;-sized unsigned integer.</div><div class="ttdef"><b>Definition</b> Unsigned.h:42</div></div>
<div class="ttc" id="anamespacegf2_html_ad1d8969ed4ed705fbc26eec1eed8b6ae"><div class="ttname"><a href="namespacegf2.html#ad1d8969ed4ed705fbc26eec1eed8b6ae">gf2::BITS</a></div><div class="ttdeci">constexpr u8 BITS</div><div class="ttdoc">The number of bits in an Unsigned returned as a u8.</div><div class="ttdef"><b>Definition</b> Unsigned.h:55</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.15.0-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>include</b></li><li class="navelem"><b>gf2</b></li><li class="navelem"><a href="BitGauss_8h.html">BitGauss.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
