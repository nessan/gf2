<!-- HTML header for doxygen 1.15.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
    <head>
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=11" />
        <meta name="generator" content="Doxygen 1.15.0" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>GF2++: The &lt;tt&gt;BitPolynomial&lt;/tt&gt; Class</title>
        <link href="tabs.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <script type="text/javascript" src="clipboard.js"></script>
        <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
 <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
 <script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  loader: {
    load: ['[tex]/mathtools']
  },
  tex: {
    macros: {},
    packages: {
        '[+]': ['mathtools']
    }
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-chtml.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
        <!-- ... other metadata & script includes ... -->
        <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
        <script type="text/javascript">
            DoxygenAwesomeDarkModeToggle.init();
        </script>
    </head>
    <body>
            <div id="top">
                <!-- do not remove this div, it is closed by doxygen! -->
                <div id="titlearea">
                    <table cellspacing="0" cellpadding="0">
                        <tbody>
                            <tr id="projectrow">
                                <td id="projectalign">
                                    <div id="projectname">
                                        GF2++
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- end header part -->
            </div>
        </div>
    </body>
</html>
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_docs_2pages_2BitPolynomial.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">The <span class="tt">BitPolynomial</span> Class </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="the-bitpolynomial-class"></a></p>
<h1 class="doxsection"><a class="anchor" id="introduction-5"></a>
Introduction</h1>
<p>A <span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a></span> is a polynomial over <a href="https://en.wikipedia.org/wiki/GF(2)">GF2</a></p>
<p>$$ p(x) = c_0 + c_1 x + c_2 x^2 + ... + c_n x^n $$</p>
<p>where each coefficient \(c_i\) is either 0 or 1 and arithmetic is performed modulo 2.</p>
<p>The polynomial coefficients are stored as a <span class="tt"><a class="el" href="classgf2_1_1BitVector.html" title="A dynamically-sized vector over GF(2) with bit elements compactly stored in a standard vector of prim...">gf2::BitVector</a></span>, and every operation is word-oriented and fast.</p>
<h1 class="doxsection"><a class="anchor" id="declaration-3"></a>
Declaration</h1>
<p><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a></span> is declared as:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;Un<span class="keywordtype">signed</span> Word = usize&gt;</div>
<div class="line"><span class="keyword">class </span>BitPolynomial {</div>
<div class="line"> <span class="comment">// ...</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>The polynomial's coefficients are stored in a <span class="tt"><a class="el" href="classgf2_1_1BitVector.html" title="A dynamically-sized vector over GF(2) with bit elements compactly stored in a standard vector of prim...">gf2::BitVector</a></span>, and the <span class="tt">Word</span> template parameter specifies the underlying unsigned integer type used to back that vector. The default <span class="tt">Word</span> is usually the most efficient type for the target platform. On most modern CPU's, that <a href="https://en.cppreference.com/w/cpp/types/size_t"><span class="tt">usize</span></a> will be a 64-bit unsigned integer.</p>
<p>If your application calls for a vast number of low-degree polynomials, you might consider using <span class="tt">std::uint8_t</span> as the <span class="tt">Word</span> type to save memory.</p>
<dl class="section note"><dt>Note</dt><dd>You might notice that many of the <a href="https://nessan.github.io/doxytest/">doctests</a> in the library use 8-bit underlying words. <br  />
 The reason is we want to exercise the various methods across word boundaries for modest, easily readable bit-polynomials.</dd></dl>
<h1 class="doxsection"><a class="anchor" id="constructors"></a>
Constructors</h1>
<p>The following constructors are available for <span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a></span> objects:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method Name  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a9288a6402252424b52e4208d9129c5a8" title="The default constructor creates an empty bit-polynomial with no coefficients.">gf2::BitPolynomial::BitPolynomial()</a></span>  </td><td class="markdownTableBodyNone">The default constructor creates the zero bit-polynomial \(p(x) \coloneqq 0\).  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a9288a6402252424b52e4208d9129c5a8" title="The default constructor creates an empty bit-polynomial with no coefficients.">gf2::BitPolynomial::BitPolynomial</a>(const BitVector&lt;Word&gt;&amp; coeffs)</span>  </td><td class="markdownTableBodyNone">Constructs a bit-vector by <em>copying</em> the passed vector of coefficients.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a9288a6402252424b52e4208d9129c5a8" title="The default constructor creates an empty bit-polynomial with no coefficients.">gf2::BitPolynomial::BitPolynomial</a>(BitVector&lt;Word&gt;&amp;&amp; coeffs)</span>  </td><td class="markdownTableBodyNone">Constructs a bit-vector by <em>moving</em> the passed vector of coefficients.  </td></tr>
</table>
<p>If <span class="tt">c</span> is a <span class="tt"><a class="el" href="classgf2_1_1BitVector.html" title="A dynamically-sized vector over GF(2) with bit elements compactly stored in a standard vector of prim...">gf2::BitVector</a></span> representing the coefficients of a polynomial, then <span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a> p{c}</span> creates a <span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a></span> which <em>copies</em> its coefficients from <span class="tt">c</span>. On the other hand, <span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a> p{std::move(c)}</span> creates a <span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a></span> which <em>moves</em> <span class="tt">c</span> into its coefficients, and leaving <span class="tt">c</span> in an unspecified state.</p>
<h2 class="doxsection"><a class="anchor" id="factory-constructors"></a>
Factory Constructors</h2>
<p>Other construction methods are available as static <em>factory</em> methods:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method Name  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a7356e7edef04de04ab53c509941812e8" title="Factory method to return the &quot;zero&quot; bit-polynomial p(x) := 0.">gf2::BitPolynomial::zero</a></span>  </td><td class="markdownTableBodyNone">Returns the constant zero polynomial \(p(x) \coloneqq 0\).  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a4d1a91a4370f0999c651c83ac86faaf7" title="Factory method to return the &quot;one&quot; bit-polynomial p(x) := 1.">gf2::BitPolynomial::one</a></span>  </td><td class="markdownTableBodyNone">Returns the constant polynomial \(p(x) \coloneqq 1\)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a989aa8102d0470dea8397a15e3f66fdb" title="Factory method to return the constant bit-polynomial p(x) := val where val is a boolean.">gf2::BitPolynomial::constant</a></span>  </td><td class="markdownTableBodyNone">Returns the constant polynomial \(p(x) \coloneqq 0 \text{ or } 1\) depending on the passed value.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a27afefe457918a27afde17fa3c233ad4" title="Factory method to return a bit-polynomial with n + 1 coefficients, all initialized to zero.">gf2::BitPolynomial::zeros</a></span>  </td><td class="markdownTableBodyNone">Returns the polynomial \(p(x) \coloneqq 0 + 0x + 0x^2 + \ldots + 0x^n\) where \(n\) is the passed argument.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a5f4593b61b4e2eb435b33218930e279d" title="Factory method to return a monic bit-polynomial of degree n with n + 1 coefficients,...">gf2::BitPolynomial::ones</a></span>  </td><td class="markdownTableBodyNone">Returns the polynomial \(p(x) \coloneqq 1 + x + x^2 + \ldots + x^d\). where \(d\) is the passed argument.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a6907fccf1e429bc894f952d3eb17a059" title="Factory method to return the bit-polynomial p(x) := x^n.">gf2::BitPolynomial::x_to_the</a></span>  </td><td class="markdownTableBodyNone">Returns the polynomial \(p(x) \coloneqq x^n\) where \(n\) is the passed argument.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a5fc0a519edcf2b5f905430512607918b" title="Factory method to return a new bit-polynomial of degree n with coefficients set by calling the functi...">gf2::BitPolynomial::from</a></span>  </td><td class="markdownTableBodyNone">Returns a polynomial whose coefficients are determined by repeatedly calling the passed function.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a837fb37511b510d33f40414feaef6c42" title="Factory method to return a new bit-polynomial of degree n with n + 1 coefficients picked uniformly at...">gf2::BitPolynomial::random</a></span>  </td><td class="markdownTableBodyNone">Returns a random polynomial of a particular degree.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#ab8b98b3994a5606bf01b3bde4a126d3d" title="Factory method to return a new bit-polynomial of degree n with n + 1 coefficients picked uniformly at...">gf2::BitPolynomial::seeded_random</a></span>  </td><td class="markdownTableBodyNone">Returns a random polynomial of a particular degree, determined by an RNG seeded for repeatability.  </td></tr>
</table>
<p>It is worth noting that there are multiple representations possible for the zero polynomial \(p(x) \coloneqq 0\).</p>
<p>In the library, the <em>empty polynomial</em> (the one with no coefficients at all) is considered to be a zero polynomial.</p>
<p>So also is the polynomial \(0 + 0x + 0x^2 + ... + 0x^n\) for any \(n \geq 0\) &ndash; this is what is returned by <span class="tt">gf2::BitPolynomial::zeros(n)</span>.</p>
<h1 class="doxsection"><a class="anchor" id="queries"></a>
Queries</h1>
<p>There following methods query a <span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a></span> object:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method Name  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a8ae665db25f0ca00d53a4d8275c2a579" title="Returns the degree of the bit-polynomial.">gf2::BitPolynomial::degree</a></span>  </td><td class="markdownTableBodyNone">Returns the degree of the polynomial (returns 0 for any zero polynomial).  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#ad38c2969e7285ab9ba99b67a02b8241c" title="Returns the &quot;size&quot; of the bit-polynomial which is its total number of coefficients.">gf2::BitPolynomial::size</a></span>  </td><td class="markdownTableBodyNone">Returns the number of polynomial coefficients.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a259bc0b612c3667b0f4635e5ce154f31" title="Returns true if the bit-polynomial is some form of the zero BitPolynomial p(x) := 0.">gf2::BitPolynomial::is_zero</a></span>  </td><td class="markdownTableBodyNone">Returns <span class="tt">true</span> if this is some form of the zero polynomial.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a3ed518bd6a066a8858b6bb54e2dd93fd" title="Returns true if the bit-polynomial is non-zero.">gf2::BitPolynomial::is_non_zero</a></span>  </td><td class="markdownTableBodyNone">Returns <span class="tt">true</span> if this is not some form of the zero polynomial.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#adddccba2c1d877e846c552619a21fda3" title="Returns true if the bit-polynomial is p(x) := 1.">gf2::BitPolynomial::is_one</a></span>  </td><td class="markdownTableBodyNone">Returns <span class="tt">true</span> if this is the polynomial \(p(x) \coloneqq 1\) .  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a6a35a5252e6ab3b7d606293ac0bde657" title="Returns true if the bit-polynomial is either p(x) := 0 or 1.">gf2::BitPolynomial::is_constant</a></span>  </td><td class="markdownTableBodyNone">Returns <span class="tt">true</span> if this is the polynomial \(p(x) \coloneqq 0 \text{ or } 1\).  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#ae4c6c41981c36e0ad1fe58288833b01b" title="Returns true if the bit-polynomial is monic, i.e., no trailing zero coefficients.">gf2::BitPolynomial::is_monic</a></span>  </td><td class="markdownTableBodyNone">Returns <span class="tt">true</span> if there are no high order zero coefficients.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a8d28bd071e4e7344d0c8e9a34f550ea8" title="Returns true if the bit-polynomial is empty, i.e., has no coefficients.">gf2::BitPolynomial::is_empty</a></span>  </td><td class="markdownTableBodyNone">Returns <span class="tt">true</span> if this polynomial has no coefficients  </td></tr>
</table>
<p>A polynomial is considered <em>monic</em> if its leading coefficient (the coefficient of the highest-degree term) is 1.</p>
<p>For example, the polynomial \(p(x) = x^3 + x + 1\) is monic, while \(q(x) = 0x^4 + x^3 + x + 1\) is not monic because its leading coefficient is 0. Both those polynomials have degree 3.</p>
<h1 class="doxsection"><a class="anchor" id="coefficient-access"></a>
Coefficient Access</h1>
<p>There are methods to access and modify the polynomial coefficients either individually or as a whole:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method Name  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">gf2::BitPolynomial::operator[]() const</span>  </td><td class="markdownTableBodyNone">Returns a polynomial coefficient as a read-only boolean.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a76532c77d1269321732baeb2b342f0bb" title="Returns the coefficient of  in the bit-polynomial as a boolean.">gf2::BitPolynomial::operator[]()</a></span>  </td><td class="markdownTableBodyNone">Returns a polynomial coefficient as a read-write <span class="tt"><a class="el" href="classgf2_1_1BitRef.html" title="A BitRef is a proxy class to reference a single bit in a bit-store.">gf2::BitRef</a></span>.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a15acc6d7b5115d5ec9bb98908e4462b3" title="Read-only access to all the coefficients of the bit-polynomial.">gf2::BitPolynomial::coefficients</a> const</span>  </td><td class="markdownTableBodyNone">Returns a read-only reference to the coefficient bit-vector.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a15acc6d7b5115d5ec9bb98908e4462b3" title="Read-only access to all the coefficients of the bit-polynomial.">gf2::BitPolynomial::coefficients</a></span>  </td><td class="markdownTableBodyNone">Returns a read-write reference to the coefficient bit-vector.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a66016938a3da223a1dd5ce1983762faf" title="Set the bit-polynomial coefficients by copying them from a pre-filled bit-store.">gf2::BitPolynomial::copy_coefficients</a></span>  </td><td class="markdownTableBodyNone">Copies the elements from the passed bit-store to the coefficient bit-vector.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a9b9c7fc51c23aa61f8cba0e6d4342cef" title="Set the BitPolynomial coefficients by moving a bit-vector of coefficients into place.">gf2::BitPolynomial::move_coefficients</a></span>  </td><td class="markdownTableBodyNone">Moves the elements from the passed bit-store to the coefficient bit-vector.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#accdc721f4b491ca560eeb126952de1fa" title="Clears the BitPolynomial, i.e., sets it to the zero BitPolynomial &amp; returns self.">gf2::BitPolynomial::clear</a></span>  </td><td class="markdownTableBodyNone">Sets the polynomial back to \(p(x) \coloneqq 0`\).  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a98460a92a789b7f46ecf3fc2050ce6c4" title="Resizes the BitPolynomial to have the n coefficients and returns self.">gf2::BitPolynomial::resize</a></span>  </td><td class="markdownTableBodyNone">Resizes the polynomial to have the <span class="tt">n</span> coefficients (added ones are zeros).  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a03d22233357ad6872d11919977206587" title="Shrinks the BitPolynomial to have the minimum number of coefficients and returns self.">gf2::BitPolynomial::shrink_to_fit</a></span>  </td><td class="markdownTableBodyNone">Calls <span class="tt"><a class="el" href="classgf2_1_1BitVector.html#a5bf1540020eb0b155578832dcd535513" title="Shrinks the bit-vector&#39;s capacity as much as possible.">gf2::BitVector::shrink_to_fit</a></span> on the coefficient bit-vector.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a3c2782de944f53f93186505a3c5c4f0f" title="Kills any trailing zero coefficients, so e.g. p(x) := 0*x^4 + x^2 + x becomes p(x) := x^2 + x.">gf2::BitPolynomial::make_monic</a></span>  </td><td class="markdownTableBodyNone">Kills any high order zero coefficients to make the polynomial <em>monic</em>.  </td></tr>
</table>
<h1 class="doxsection"><a class="anchor" id="polynomial-pieces"></a>
Polynomial Pieces</h1>
<p>We have methods to extract sub-polynomials:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method Name  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a1b9b2ccbbd1840d8c4d278e34c812a67" title="Makes the destination bit-polynomial a copy of the low d + 1 coefficients of this bit-polynomial....">gf2::BitPolynomial::sub</a></span>  </td><td class="markdownTableBodyNone">Extract a bit-polynomial that is a copy of some low degree terms.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#aa689ce1a2406150ca949056456d6c389" title="Splits the bit-polynomial into a low and high part where the low part has degree at most d....">gf2::BitPolynomial::split</a></span>  </td><td class="markdownTableBodyNone">Extract two bit-polynomials <span class="tt">lo</span> and <span class="tt">hi</span>, <span class="tt">lo</span> is a copy of low degree terms and <span class="tt">hi</span> is the rest.  </td></tr>
</table>
<p>Both methods can be passed pre-allocated polynomial(s) to store the result(s) to avoid unnecessary allocations. For example:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> p = <a class="code hl_function" href="classgf2_1_1BitPolynomial.html#a837fb37511b510d33f40414feaef6c42">gf2::BitPolynomial&lt;&gt;::random</a>(100);   <span class="comment">// Random degree 100 polynomial, so 101 coefficients.</span></div>
<div class="line"><span class="keyword">auto</span> [l, h] = p.split(50);                    <span class="comment">// First 51 coefficients in lo, rest in hi.</span></div>
<div class="ttc" id="aclassgf2_1_1BitPolynomial_html_a837fb37511b510d33f40414feaef6c42"><div class="ttname"><a href="classgf2_1_1BitPolynomial.html#a837fb37511b510d33f40414feaef6c42">gf2::BitPolynomial::random</a></div><div class="ttdeci">static constexpr BitPolynomial random(usize n)</div><div class="ttdoc">Factory method to return a new bit-polynomial of degree n with n + 1 coefficients picked uniformly at...</div><div class="ttdef"><b>Definition</b> BitPolynomial.h:172</div></div>
</div><!-- fragment --><p>On return, <span class="tt">l</span> will be a polynomial of degree at most 50 (so have at most 51 coefficients) and <span class="tt">h</span> will be a polynomial of degree at most 49 (so have at most 50 coefficients). The original polynomial can be reconstructed as:</p>
<p>$$ p(x) = l(x) + x^{51} h(x) $$</p>
<p>The same code can be written to avoid allocations as:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> p = <a class="code hl_function" href="classgf2_1_1BitPolynomial.html#a837fb37511b510d33f40414feaef6c42">gf2::BitPolynomial&lt;&gt;::random</a>(100);   <span class="comment">// Random degree</span></div>
<div class="line">BitPolynomial&lt;&gt; l, h;</div>
<div class="line">p.split(50, l, h);                            <span class="comment">// First 51 coefficients in lo, rest in hi.</span></div>
</div><!-- fragment --><p>This is useful if the split operation is being performed repeatedly in an algorithm.</p>
<h1 class="doxsection"><a class="anchor" id="arithmetic-operations"></a>
Arithmetic Operations</h1>
<p>We have all the usual arithmetic operations defined for <span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a></span> objects where the addition and subtraction operations are identical since we are working over GF(2).</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method Name  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#ae7da0476a16cb8123348ddaf33cc4519" title="In-place addition with another bit-polynomial, returning a reference to the result.">gf2::BitPolynomial::operator+=()</a></span>  </td><td class="markdownTableBodyNone">In-place addition with another bit-polynomial.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#af5976981c47b34d0159ff3ed37bfa0a2" title="In-place subtraction with another bit-polynomial, returning a reference to the result.">gf2::BitPolynomial::operator-=()</a></span>  </td><td class="markdownTableBodyNone">In-place subtraction with another bit-polynomial.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a7b57b4ed37a59ff017904a2dd3f6c216" title="In-place multiplication with another bit-polynomial, returning a reference to the result.">gf2::BitPolynomial::operator*=()</a></span>  </td><td class="markdownTableBodyNone">In-place multiplication by another bit-polynomial.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a9a34034e4decc2b91209488d598d892f" title="Returns the sum of two bit-polynomials.">gf2::BitPolynomial::operator+()</a></span>  </td><td class="markdownTableBodyNone">Adds another polynomial to this one and returns the result as a new bit-polynomial.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a94757bdf3dd733c53c940c1fd05083dd" title="Returns the difference of two bit-polynomials.">gf2::BitPolynomial::operator-()</a></span>  </td><td class="markdownTableBodyNone">Subtracts another polynomial from this one and returns the result as a new bit-polynomial.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#ada1764cdb89b7fed87ad03971af2c4c2" title="Returns the product of two bit-polynomials.">gf2::BitPolynomial::operator*()</a></span>  </td><td class="markdownTableBodyNone">Multiplies this and another polynomial and returns the result as a new bit-polynomial.  </td></tr>
</table>
<p><b>TODO:</b> As yet, we have not implemented polynomial division.</p>
<dl class="section note"><dt>Note</dt><dd>Considerable speed improvements are possible by using carryless multiplication algorithms. However, for now at least, those depend on using platform-specific intrinsics which complicates the library and, in particular, testing the library across multiple platforms. <br  />
 So for the time being, we stick to a more portable convolution approach using <span class="tt"><a class="el" href="namespacegf2.html#a3b0ea5c405d2ed08ce9fa5bbbb2cc169" title="Convolutions:">gf2::convolve</a></span> on the coefficient bit-vectors.</dd></dl>
<p>However, we do have a couple of "fast" methods for common arithmetic operations:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method Name  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a30309419a9ed46754fc450052ef19bfb" title="Fills dst with the square of this bit-polynomial.">gf2::BitPolynomial::squared</a></span>  </td><td class="markdownTableBodyNone">Computes the polynomial \(p(x)^2\).  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a178abb5ed13f4efe219136a7a7c07fee" title="Multiplies the BitPolynomial by x^n and returns self.">gf2::BitPolynomial::times_x_to_the</a></span>  </td><td class="markdownTableBodyNone">Performs the in-place operation \(p(x) \rightarrow x^n p(x)\) .  </td></tr>
</table>
<p>The squaring operation is optimised since in GF(2), squaring a polynomial simply involves inserting zero coefficients between each existing coefficient (see <span class="tt"><a class="el" href="namespacegf2.html#ac462028756047a28bd47ba5134841371" title="Interleaves the bits of a bit-store with zeros storing the result into the passed bit-vector dst.">gf2::riffle</a></span>).</p>
<p>The <span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a30309419a9ed46754fc450052ef19bfb" title="Fills dst with the square of this bit-polynomial.">gf2::BitPolynomial::squared</a></span> can be passed a pre-allocated polynomial to store the result &mdash; this is important for algorithms that require repeated squaring to avoid unnecessary allocations. See for example the [modular reduction] technical note for details.</p>
<p>Multiplication by \(x^n\) is also optimised since it simply involves bit-shifting the coefficients.</p>
<p>Those methods are much faster than using the general multiplication operator \(p(x) * q(x)\) when \(q(x) = x^n\) or \(p(x)\).</p>
<h1 class="doxsection"><a class="anchor" id="polynomial-evaluation"></a>
Polynomial Evaluation</h1>
<p>There are methods to evaluate a bit-polynomial for a scalar value or for any <em>square</em> bit-matrix:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method Name  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">gf2::BitPolynomial::operator()(bool x)</span>  </td><td class="markdownTableBodyNone">Evaluates the polynomial at the passed bit value <span class="tt">x</span>.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">gf2::BitPolynomial::operator()(const BitMatrix&lt;Word&gt;&amp; M)</span>  </td><td class="markdownTableBodyNone">Evaluates the polynomial at the passed square bit-matrix <span class="tt">M</span>.  </td></tr>
</table>
<p>Matrix evaluation uses <a href="https://en.wikipedia.org/wiki/Horner%27s_method">Horner's method</a> to evaluate <span class="tt">p(M)</span> where <span class="tt">M</span> is a square matrix. The result is returned as a new bit-matrix.</p>
<h1 class="doxsection"><a class="anchor" id="modular-reduction"></a>
Modular Reduction</h1>
<p>We have a method to compute \(x^N \bmod{p(x)}\) where \(p(x)\) is a bit-polynomial and \(N\) is a potentially huge integer:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method Name  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#abdd695f14c6c1087e441a15b2ec41250" title="If this polynomial is P(x) we return x^e mod P(x) for e = n or e = 2^n depending on the n_is_log2 arg...">gf2::BitPolynomial::reduce_x_to_the</a></span>  </td><td class="markdownTableBodyNone">Returns the polynomial \(x^N \bmod{p(x)}\) where \(N\) is the passed integer.  </td></tr>
</table>
<p>This method can handle <em>very</em> large values of \(N\). <br  />
 See the [modular reduction] technical note for more details.</p>
<h1 class="doxsection"><a class="anchor" id="stringification"></a>
Stringification</h1>
<p>The following methods return a string representation for a bit-polynomial.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#ad1fbf0f547d577a09ae151e9ca28deea" title="Returns a readable string representation of the bit-polynomial p(x) = p0 + p1x + ....">gf2::BitPolynomial::to_string</a></span>  </td><td class="markdownTableBodyNone">Returns a string representation where zero coefficients are not shown.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html#a4fb80fdbc97e94b8d7836329ace31f89" title="Returns a readable full string representation of the bit-polynomial.">gf2::BitPolynomial::to_full_string</a></span>  </td><td class="markdownTableBodyNone">Returns a string representation where zero coefficients are all shown..  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">gf2::BitPolynomial::operator&lt;&lt;(std::ostream&amp;)</span>  </td><td class="markdownTableBodyNone">The usual output stream output stream operator for bit-polynomials.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">struct std::formatter&lt;<a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a>&gt;</span>  </td><td class="markdownTableBodyNone">Specialisation of <a href="https://en.cppreference.com/w/cpp/utility/format/formatter"><span class="tt">std::formatter</span></a> for bit-polynomials.  </td></tr>
</table>
<p>The <span class="tt">to_string</span> and <span class="tt">to_full_string</span> methods can be passed a string argument to specify the variable name. The default variable name is <span class="tt">x</span>.</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> p = BitPolynomial&lt;&gt;::ones(3);</div>
<div class="line">assert_eq(p.to_string(), <span class="stringliteral">&quot;1 + x + x^2 + x^3&quot;</span>);</div>
<div class="line">assert_eq(p.to_string(<span class="stringliteral">&quot;M&quot;</span>), <span class="stringliteral">&quot;1 + M + M^2 + M^3&quot;</span>);</div>
</div><!-- fragment --><p>For <a href="https://en.cppreference.com/w/cpp/utility/format/formatter"><span class="tt">std::formatter</span></a> you can set the variable name using a format specifier:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> p = BitPolynomial&lt;&gt;::ones(2);</div>
<div class="line">std::println(<span class="stringliteral">&quot;{:x}&quot;</span>, p);      <span class="comment">// prints &quot;1 + x + x^2&quot;</span></div>
<div class="line">std::println(<span class="stringliteral">&quot;{:M}&quot;</span>, p);      <span class="comment">// prints &quot;1 + M + M^2&quot;</span></div>
<div class="line">std::println(<span class="stringliteral">&quot;{:mat}&quot;</span>, p);   <span class="comment">// prints &quot;1 + mat + mat^2&quot;</span></div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="see-also-5"></a>
See Also</h1>
<ul>
<li><span class="tt"><a class="el" href="classgf2_1_1BitPolynomial.html" title="A BitPolynomial represents a polynomial over GF(2) where we store the polynomial coefficients in a bi...">gf2::BitPolynomial</a></span> for detailed documentation of all class methods.</li>
<li><a class="el" href="md_docs_2pages_2BitStore.html"><span class="tt">BitStore</span></a> for the concept API shared by all bit-stores.</li>
<li><a class="el" href="md_docs_2pages_2BitArray.html"><span class="tt">BitArray</span></a> for fixed-size vectors of bits.</li>
<li><a class="el" href="md_docs_2pages_2BitVector.html"><span class="tt">BitVector</span></a> for dynamically-sized vectors of bits.</li>
<li><a class="el" href="md_docs_2pages_2BitSpan.html"><span class="tt">BitSpan</span></a> for non-owning views into any bit-store.</li>
<li><a class="el" href="md_docs_2pages_2BitMatrix.html"><span class="tt">BitMatrix</span></a> for matrices of bits.</li>
<li>[Modular Reduction](Reduction) for details on the modular reduction \(x^N \bmod{p(x)}\). </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.15.0-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
